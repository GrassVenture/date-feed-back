# DateFeedBack タスク一覧

## 📋 概要

マッチングアプリ等で出会った異性とのデート会話を録音・分析し、フィードバックを提供する Flutter Web アプリケーションの実装タスクを整理します。MVC パターンと HooksRiverpod を採用し、段階的に機能を実装していきます。

## ✅ タスクリスト

### フェーズ 1: プロジェクトセットアップ

1. **プロジェクト初期化**

   - 概要: Flutter Web プロジェクトの作成と基本設定
   - 完了条件:
     - [ ] `flutter create`でプロジェクト作成
     - [ ] `pubspec.yaml`に必要なパッケージを追加
       - hooks_riverpod
       - firebase_core
       - firebase_auth
       - cloud_firestore
       - google_cloud_storage
     - [ ] Firebase/GCP プロジェクトの設定
     - [ ] GitHub リポジトリの設定
   - 動作確認:
     - [ ] `flutter pub get`が正常に完了
     - [ ] `flutter run -d chrome`でビルドが通ること
     - [ ] Firebase 接続確認
   - メモ: バージョン指定は`pubspec.yaml`で明示的に行う

2. **ディレクトリ構造の整備**
   - 概要: MVC パターンに基づくディレクトリ構造の作成
   - 完了条件:
     - [ ] 以下のディレクトリ構造を作成:
       ```
       lib/
       ├── auth/
       │   ├── models/
       │   ├── views/
       │   ├── controllers/
       │   └── providers/
       ├── upload/
       │   ├── models/
       │   ├── views/
       │   ├── controllers/
       │   └── providers/
       ├── analysis/
       │   ├── models/
       │   ├── views/
       │   ├── controllers/
       │   └── providers/
       └── core/
           ├── constants/
           ├── utils/
           └── widgets/
       ```
   - 動作確認:
     - [ ] ディレクトリ構造が正しく作成されていること

### フェーズ 2: 音声アップロード機能実装

6. **アップロードモデルの実装**

   - 概要: 音声ファイルアップロードに関するモデルの実装
   - 完了条件:
     - [ ] `AudioFileModel`クラスの実装
     - [ ] GCS 署名付き URL 生成ロジックの実装
     - [ ] 15分を超える音声ファイルは冒頭15分のみ抽出するロジックの実装
   - 動作確認:
     - [ ] ユニットテストの作成と実行
     - [ ] GCS への冒頭15分ファイルアップロードテスト

7. **アップロード UI の実装**

   - 概要: 音声ファイルアップロード画面の実装
   - 完了条件:
     - [ ] `UploadPage` (HookConsumerWidget)の実装
     - [ ] ドラッグ&ドロップ対応
     - [ ] ファイル選択ダイアログ対応
     - [ ] アップロード進捗表示（冒頭15分ファイルの進捗を表示）
   - 動作確認:
     - [ ] ファイル選択の動作確認
     - [ ] プログレスバーの表示確認
     - [ ] エラー表示の確認

8. **アップロード状態管理の実装**
   - 概要: アップロード状態の HooksRiverpod 実装
   - 完了条件:
     - [ ] `UploadController`の実装
     - [ ] `UploadStateNotifier`の実装
     - [ ] カスタム Hook `useFileUpload`の実装
     - [ ] 冒頭15分ファイルのアップロード状態管理
   - 動作確認:
     - [ ] アップロード状態の変更テスト
     - [ ] エラーハンドリングのテスト

### フェーズ 3: 分析結果表示機能実装

9. **分析モデルの実装**

   - 概要: 分析結果に関するモデルクラスの実装
   - 完了条件:
     - [ ] `TranscriptModel`の実装
     - [ ] `FeedbackModel`の実装
     - [ ] `AnalysisModel`の実装
   - 動作確認:
     - [ ] ユニットテストの作成と実行
     - [ ] JSON パース処理の確認

10. **音声プレイヤーの実装**

    - 概要: 音声再生機能の実装
    - 完了条件:
      - [ ] `AudioPlayerWidget` (HookConsumerWidget)の実装
      - [ ] 再生/一時停止/シーク機能
    - 動作確認:
      - [ ] 音声再生の動作確認
      - [ ] シーク機能の動作確認

11. **文字起こし表示の実装**

    - 概要: 文字起こし結果表示機能の実装
    - 完了条件:
      - [ ] `TranscriptWidget` (HookConsumerWidget)の実装
      - [ ] 話者別の表示スタイル
      - [ ] タイムスタンプ表示
    - 動作確認:
      - [ ] 表示レイアウトの確認
      - [ ] スクロール動作の確認

12. **グラフ表示の実装**

    - 概要: 非言語情報のグラフ表示機能の実装
    - 完了条件:
      - [ ] `GraphWidget` (HookConsumerWidget)の実装
      - [ ] 時系列データの描画
    - 動作確認:
      - [ ] グラフ描画の確認
      - [ ] インタラクションの確認

13. **フィードバック表示の実装**

    - 概要: AI フィードバック表示機能の実装
    - 完了条件:
      - [ ] `FeedbackWidget` (HookConsumerWidget)の実装
      - [ ] Markdown パース処理
    - 動作確認:
      - [ ] カード表示の確認
      - [ ] Markdown 描画の確認

14. **分析結果状態管理の実装**
    - 概要: 分析結果の状態管理実装
    - 完了条件:
      - [ ] `AnalysisController`の実装
      - [ ] 各種 StateNotifier の実装
    - 動作確認:
      - [ ] 状態更新の伝播確認
      - [ ] エラーハンドリングの確認

### フェーズ 4: 認証機能実装

3. **認証モデルの実装**

   - 概要: ユーザー認証に関するモデルクラスの実装
   - 完了条件:
     - [ ] `UserModel`クラスの実装
     - [ ] Firebase Authentication との連携
   - 動作確認:
     - [ ] ユニットテストの作成と実行
     - [ ] `

## 優先度：MEDIUM（基本機能後に着手）

### エラーハンドリング

- [ ] エラーメッセージの日本語化
- [ ] エラー表示コンポーネント（エラーダイアログ）実装
- [ ] 各種エラー（アップロード失敗、音声処理エラー、Gemini API エラー）発生時にエラーダイアログを表示し、ユーザーに分かりやすく通知する
- [ ] リトライ処理実装（必要に応じて再アップロードや再分析の案内を行う）